<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#1e293b">
    <title>Daily Goal Tracker</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; overflow-x: hidden; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 4px; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
        .success-toast { animation: slideIn 0.3s ease-out; }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 min-h-screen">
    <div id="app"></div>

    <script type="module">
        // Icons as SVG strings
        const Icons = {
            Plus: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>`,
            Download: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>`,
            Trash: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>`,
            Target: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>`,
            Check: `<svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="m9 12 2 2 4-4"/></svg>`,
            Save: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>`,
            Sparkles: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/></svg>`,
            Chart: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3v18h18"/><path d="M18 17V9"/><path d="M13 17V5"/><path d="M8 17v-3"/></svg>`,
            Zap: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>`,
            Award: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>`,
            Trend: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>`
        };

        class GoalTracker {
            constructor() {
                this.goals = JSON.parse(localStorage.getItem('currentGoals')) || [
                    { id: 1, name: 'Morning Exercise', completed: false, category: 'Health' },
                    { id: 2, name: 'Drink 8 Glasses of Water', completed: false, category: 'Health' },
                    { id: 3, name: 'Meditate 10 Minutes', completed: false, category: 'Wellness' }
                ];
                this.history = JSON.parse(localStorage.getItem('history')) || [];
                this.viewMode = 'week';
                this.categories = ['Health', 'Work', 'Personal', 'Learning', 'Wellness', 'Finance'];
                this.init();
            }

            init() {
                this.render();
                this.attachEventListeners();
            }

            getCompletionRate() {
                const completed = this.goals.filter(g => g.completed).length;
                return this.goals.length > 0 ? Math.round((completed / this.goals.length) * 100) : 0;
            }

            getStreak() {
                let streak = 0;
                const sorted = [...this.history].sort((a, b) => b.timestamp - a.timestamp);
                for (let day of sorted) {
                    if (day.completionRate >= 80) streak++;
                    else break;
                }
                return streak;
            }

            getAnalytics() {
                const now = Date.now();
                const day = 24 * 60 * 60 * 1000;
                let days = this.history;
                
                if (this.viewMode === 'week') days = this.history.filter(h => now - h.timestamp < 7 * day);
                else if (this.viewMode === 'month') days = this.history.filter(h => now - h.timestamp < 30 * day);
                else if (this.viewMode === 'year') days = this.history.filter(h => now - h.timestamp < 365 * day);

                const goalStats = {};
                days.forEach(d => {
                    d.goals.forEach(g => {
                        if (!goalStats[g.name]) goalStats[g.name] = { completed: 0, total: 0 };
                        goalStats[g.name].total++;
                        if (g.completed) goalStats[g.name].completed++;
                    });
                });

                const performance = Object.keys(goalStats).map(name => ({
                    name,
                    rate: goalStats[name].total > 0 ? Math.round((goalStats[name].completed / goalStats[name].total) * 100) : 0,
                    completed: goalStats[name].completed,
                    total: goalStats[name].total
                })).sort((a, b) => a.rate - b.rate);

                const avgCompletion = days.length > 0 ? Math.round(days.reduce((sum, d) => sum + d.completionRate, 0) / days.length) : 0;
                const perfectDays = days.filter(d => d.completionRate === 100).length;

                return { performance, avgCompletion, perfectDays, daysTracked: days.length };
            }

            addGoal(name, category) {
                if (name.trim()) {
                    this.goals.push({ id: Date.now(), name: name.trim(), completed: false, category });
                    this.save();
                    this.render();
                }
            }

            toggleGoal(id) {
                const goal = this.goals.find(g => g.id === id);
                if (goal) {
                    goal.completed = !goal.completed;
                    this.save();
                    
                    const allComplete = this.goals.every(g => g.completed);
                    if (allComplete && this.goals.length > 0) {
                        this.showSuccess();
                    }
                    this.render();
                }
            }

            deleteGoal(id) {
                this.goals = this.goals.filter(g => g.id !== id);
                this.save();
                this.render();
            }

            saveDay() {
                const today = new Date().toLocaleDateString();
                const dayData = {
                    date: today,
                    goals: this.goals.map(g => ({ name: g.name, completed: g.completed, category: g.category })),
                    completionRate: this.getCompletionRate(),
                    timestamp: Date.now()
                };

                const existingIndex = this.history.findIndex(h => h.date === today);
                if (existingIndex >= 0) {
                    this.history[existingIndex] = dayData;
                } else {
                    this.history.push(dayData);
                }

                this.history = this.history.slice(-365);
                localStorage.setItem('history', JSON.stringify(this.history));
                this.showSuccess('Day saved! ðŸŽ‰');
                this.render();
            }

            resetDay() {
                this.goals.forEach(g => g.completed = false);
                this.save();
                this.render();
            }

            save() {
                localStorage.setItem('currentGoals', JSON.stringify(this.goals));
            }

            exportCSV() {
                const rows = [['Date', 'Goal', 'Category', 'Completed', 'Daily Rate']];
                this.history.forEach(day => {
                    day.goals.forEach(goal => {
                        rows.push([day.date, goal.name, goal.category || 'Uncategorized', goal.completed ? 'Yes' : 'No', `${day.completionRate}%`]);
                    });
                });

                const csv = rows.map(row => row.map(cell => `"${cell}"`).join(',')).join('\\n');
                const blob = new Blob([csv], { type: 'text/csv' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `goal-tracker-${Date.now()}.csv`;
                a.click();
            }

            showSuccess(msg = 'Success!') {
                const toast = document.getElementById('success-toast');
                toast.innerHTML = `<div class="flex items-center gap-3">${Icons.Sparkles}<span class="font-semibold">${msg}</span></div>`;
                toast.classList.remove('hidden');
                setTimeout(() => toast.classList.add('hidden'), 2000);
            }

            getCategoryColor(cat) {
                const colors = {
                    Health: 'from-green-400 to-emerald-500',
                    Work: 'from-blue-400 to-indigo-500',
                    Personal: 'from-purple-400 to-pink-500',
                    Learning: 'from-yellow-400 to-orange-500',
                    Wellness: 'from-teal-400 to-cyan-500',
                    Finance: 'from-rose-400 to-red-500'
                };
                return colors[cat] || 'from-gray-400 to-gray-500';
            }

            render() {
                const rate = this.getCompletionRate();
                const analytics = this.getAnalytics();
                const streak = this.getStreak();
                const completed = this.goals.filter(g => g.completed).length;

                document.getElementById('app').innerHTML = `
                    <div id="success-toast" class="hidden fixed top-4 right-4 bg-gradient-to-r from-green-400 to-emerald-500 text-white px-6 py-4 rounded-2xl shadow-2xl z-50 success-toast"></div>

                    <div class="max-w-7xl mx-auto p-4 md:p-8">
                        <div class="mb-8">
                            <div class="flex items-center justify-between mb-2 flex-wrap gap-4">
                                <h1 class="text-4xl md:text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 via-pink-400 to-blue-400">Goal Tracker</h1>
                                <div class="flex gap-2">
                                    <button onclick="tracker.saveDay()" class="flex items-center gap-2 bg-gradient-to-r from-green-500 to-emerald-600 text-white px-5 py-3 rounded-xl hover:shadow-xl transition-all duration-300 hover:scale-105 font-medium">
                                        ${Icons.Save}<span class="hidden sm:inline">Save Day</span>
                                    </button>
                                    <button onclick="tracker.exportCSV()" class="flex items-center gap-2 bg-white/10 backdrop-blur-lg text-white px-5 py-3 rounded-xl hover:bg-white/20 transition-all duration-300 border border-white/20">
                                        ${Icons.Download}
                                    </button>
                                </div>
                            </div>
                            <p class="text-purple-300 text-lg">${new Date().toLocaleDateString()}</p>
                        </div>

                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                            <div class="bg-gradient-to-br from-purple-500/20 to-pink-500/20 backdrop-blur-xl rounded-2xl p-6 border border-white/10">
                                <div class="flex items-center gap-3 mb-2">${Icons.Target}<span class="text-white/70 text-sm font-medium">Today</span></div>
                                <div class="text-4xl font-bold text-white">${rate}%</div>
                            </div>
                            <div class="bg-gradient-to-br from-blue-500/20 to-cyan-500/20 backdrop-blur-xl rounded-2xl p-6 border border-white/10">
                                <div class="flex items-center gap-3 mb-2">${Icons.Chart}<span class="text-white/70 text-sm font-medium">Average</span></div>
                                <div class="text-4xl font-bold text-white">${analytics.avgCompletion}%</div>
                            </div>
                            <div class="bg-gradient-to-br from-orange-500/20 to-yellow-500/20 backdrop-blur-xl rounded-2xl p-6 border border-white/10">
                                <div class="flex items-center gap-3 mb-2">${Icons.Zap}<span class="text-white/70 text-sm font-medium">Streak</span></div>
                                <div class="text-4xl font-bold text-white">${streak} days</div>
                            </div>
                            <div class="bg-gradient-to-br from-green-500/20 to-emerald-500/20 backdrop-blur-xl rounded-2xl p-6 border border-white/10">
                                <div class="flex items-center gap-3 mb-2">${Icons.Award}<span class="text-white/70 text-sm font-medium">Perfect Days</span></div>
                                <div class="text-4xl font-bold text-white">${analytics.perfectDays}</div>
                            </div>
                        </div>

                        <div class="grid lg:grid-cols-3 gap-6 mb-8">
                            <div class="lg:col-span-2 bg-white/5 backdrop-blur-xl rounded-3xl p-6 border border-white/10">
                                <div class="flex items-center justify-between mb-6">
                                    <h2 class="text-2xl font-bold text-white flex items-center gap-2">${Icons.Check}Today's Goals</h2>
                                    <button onclick="tracker.resetDay()" class="text-white/50 hover:text-white/80 transition-colors text-sm">Reset All</button>
                                </div>
                                
                                <div class="mb-6">
                                    <div class="flex gap-2 flex-wrap">
                                        <input id="goalInput" type="text" placeholder="What do you want to accomplish today?" class="flex-1 min-w-[200px] px-4 py-3 bg-white/10 backdrop-blur-lg border border-white/20 rounded-xl text-white placeholder-white/50 focus:border-purple-400 focus:outline-none transition-all">
                                        <select id="categorySelect" class="px-4 py-3 bg-white/10 backdrop-blur-lg border border-white/20 rounded-xl text-white focus:border-purple-400 focus:outline-none transition-all">
                                            ${this.categories.map(cat => `<option value="${cat}" class="bg-slate-800">${cat}</option>`).join('')}
                                        </select>
                                        <button onclick="tracker.handleAddGoal()" class="bg-gradient-to-r from-purple-500 to-pink-500 text-white p-3 rounded-xl hover:shadow-xl transition-all duration-300 hover:scale-105">
                                            ${Icons.Plus}
                                        </button>
                                    </div>
                                </div>

                                <div class="space-y-3 max-h-[500px] overflow-y-auto pr-2">
                                    ${this.goals.map(goal => `
                                        <div class="group relative overflow-hidden rounded-2xl border-2 transition-all duration-300 ${goal.completed ? 'bg-gradient-to-r from-green-500/20 to-emerald-500/20 border-green-500/50' : 'bg-white/5 border-white/10 hover:border-purple-400/50'}">
                                            <div class="flex items-center gap-4 p-4">
                                                <input type="checkbox" ${goal.completed ? 'checked' : ''} onchange="tracker.toggleGoal(${goal.id})" class="w-6 h-6 rounded-lg cursor-pointer accent-green-500">
                                                <div class="flex-1">
                                                    <span class="text-lg font-medium ${goal.completed ? 'line-through text-white/50' : 'text-white'}">${goal.name}</span>
                                                    <div class="inline-block ml-3 px-3 py-1 rounded-full text-xs font-medium bg-gradient-to-r ${this.getCategoryColor(goal.category)} text-white">${goal.category}</div>
                                                </div>
                                                <button onclick="tracker.deleteGoal(${goal.id})" class="opacity-0 group-hover:opacity-100 text-red-400 hover:text-red-300 transition-all p-2">
                                                    ${Icons.Trash}
                                                </button>
                                            </div>
                                        </div>
                                    `).join('')}
                                    ${this.goals.length === 0 ? `<div class="text-center py-16 text-white/50">${Icons.Target}<p class="text-lg mt-4">Add your first goal to get started</p></div>` : ''}
                                </div>
                            </div>

                            <div class="bg-white/5 backdrop-blur-xl rounded-3xl p-6 border border-white/10">
                                <h2 class="text-2xl font-bold text-white mb-6">Progress</h2>
                                <div class="flex flex-col items-center">
                                    <div class="relative w-48 h-48">
                                        <svg class="transform -rotate-90 w-48 h-48">
                                            <circle cx="96" cy="96" r="80" stroke="rgba(255,255,255,0.1)" stroke-width="12" fill="none"/>
                                            <circle cx="96" cy="96" r="80" stroke="${rate >= 80 ? '#10b981' : rate >= 50 ? '#f59e0b' : '#ef4444'}" stroke-width="12" fill="none" stroke-dasharray="${2 * Math.PI * 80}" stroke-dashoffset="${2 * Math.PI * 80 * (1 - rate / 100)}" stroke-linecap="round"/>
                                        </svg>
                                        <div class="absolute inset-0 flex items-center justify-center">
                                            <div class="text-center">
                                                <div class="text-5xl font-bold text-white">${rate}%</div>
                                            </div>
                                        </div>
                                    </div>
                                    <p class="text-white/70 mt-4">${completed} of ${this.goals.length} completed</p>
                                </div>
                            </div>
                        </div>

                        ${this.history.length > 0 ? `
                            <div class="flex gap-3 mb-6 flex-wrap">
                                ${['week', 'month', 'year'].map(mode => `
                                    <button onclick="tracker.setViewMode('${mode}')" class="px-6 py-3 rounded-xl font-medium transition-all ${this.viewMode === mode ? 'bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg' : 'bg-white/5 text-white/70 hover:bg-white/10 border border-white/10'}">
                                        ${mode.charAt(0).toUpperCase() + mode.slice(1)}
                                    </button>
                                `).join('')}
                            </div>

                            <div class="bg-white/5 backdrop-blur-xl rounded-3xl p-6 border border-white/10">
                                <h3 class="text-xl font-bold text-white mb-4 flex items-center gap-2">${Icons.Target}Goals to Improve</h3>
                                <div class="space-y-3 max-h-[400px] overflow-y-auto pr-2">
                                    ${analytics.performance.slice(0, 5).map(goal => `
                                        <div class="bg-white/5 rounded-xl p-4 border border-white/10">
                                            <div class="flex justify-between items-center mb-2">
                                                <span class="font-medium text-white text-sm">${goal.name}</span>
                                                <span class="font-bold text-lg ${goal.rate < 50 ? 'text-red-400' : goal.rate < 75 ? 'text-orange-400' : 'text-green-400'}">${goal.rate}%</span>
                                            </div>
                                            <div class="w-full bg-white/10 rounded-full h-2.5">
                                                <div class="h-2.5 rounded-full transition-all bg-gradient-to-r ${goal.rate < 50 ? 'from-red-500 to-red-600' : goal.rate < 75 ? 'from-orange-500 to-yellow-500' : 'from-green-500 to-emerald-500'}" style="width: ${goal.rate}%"></div>
                                            </div>
                                            <p class="text-xs text-white/50 mt-2">${goal.completed}/${goal.total} times</p>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                `;
            }

            handleAddGoal() {
                const input = document.getElementById('goalInput');
                const select = document.getElementById('categorySelect');
                this.addGoal(input.value, select.value);
                input.value = '';
            }

            setViewMode(mode) {
                this.viewMode = mode;
                this.render();
            }

            attachEventListeners() {
                document.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && e.target.id === 'goalInput') {
                        this.handleAddGoal();
                    }
                });
            }
        }

        window.tracker = new GoalTracker();
    </script>
</body>
</html>
